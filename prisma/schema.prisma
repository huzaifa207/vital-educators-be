// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id                       Int       @id @default(autoincrement())
  first_name               String
  last_name                String
  email                    String    @unique
  username                 String    @unique
  password                 String
  address_1                String
  address_2                String
  phone                    String
  country                  String
  postal_code              String
  search_visibility        Boolean?  @default(false)
  promotion_vital_educator Boolean?  @default(false)
  promotion_third_parties  Boolean?  @default(false)
  email_approved           Boolean?
  email_token              String?   @unique
  password_reset_token     String?   @unique
  createdAt                DateTime? @default(now())
  updatedAt                DateTime? @updatedAt
  role                     Role      @default(STUDENT)
  tutor                    Tutor?
}

model Tutor {
  id             Int             @id @default(autoincrement())
  profile_url    String
  crb_check      Boolean
  skype_id       String
  deActivate     Boolean         @default(false)
  createdAt      DateTime?       @default(now())
  updatedAt      DateTime?       @updatedAt
  user           User            @relation(fields: [userId], references: [id], onDelete: Cascade)
  userId         Int             @unique
  referees       Referees[]
  qualification  Qualification[]
  tutoringDetail TutoringDetail?
  subjectOffers  SubjectOffer[]
}

model Referees {
  id         Int          @id @default(autoincrement())
  first_name String
  last_name  String
  email      String       @unique
  phone      String
  relation   RelationType @default(OTHER)
  tutor      Tutor        @relation(fields: [tutorId], references: [id], onDelete: Cascade)
  tutorId    Int
}

model Qualification {
  id                 Int    @id @default(autoincrement())
  degree_title       String
  level              String
  institute          String
  year_of_completion Int
  document           String
  tutor              Tutor  @relation(fields: [tutorId], references: [id], onDelete: Cascade)
  tutorId            Int
}

model TutoringDetail {
  id                  Int      @id @default(autoincrement())
  about               String
  year_of_experience  Int
  teaching_experience String
  approach            String
  availability        String[]
  tutor               Tutor    @relation(fields: [tutorId], references: [id], onDelete: Cascade)
  tutorId             Int      @unique
}

model SubjectOffer {
  id                Int     @id @default(autoincrement())
  title             String
  primary           Int     @default(0)
  seconday          Int     @default(0)
  gsce              Int     @default(0)
  higher_education  Int     @default(0)
  casual_learner    Int     @default(0)
  a_level           Int     @default(0)
  online_discount   Int     @default(0)
  first_free_lesson Boolean @default(false)
  in_person         Boolean @default(true)
  online            Boolean @default(true)
  tutor             Tutor   @relation(fields: [tutorId], references: [id])
  tutorId           Int
}

enum Role {
  STUDENT
  TUTOR
  ADMIN
}

enum RelationType {
  FRIEND
  TEACHER
  COLLEAGE
  CLIENT
  EMPLOYER
  OTHER
}

enum Availability {
  WEEKENDS
  WEEKDAYS
  EVENING
  MORNINIG
}
