// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id                       Int       @id @default(autoincrement())
  first_name               String
  last_name                String
  email                    String    @unique
  password                 String
  profile_url              String    @default("")
  address_1                String
  address_2                String    @default("")
  phone                    String
  country                  String
  postal_code              String
  search_visibility        Boolean?  @default(false)
  promotion_vital_educator Boolean?  @default(false)
  promotion_third_parties  Boolean?  @default(false)
  email_approved           Boolean?  @default(false)
  email_token              String?   @unique
  password_reset_token     Int?      @unique
  createdAt                DateTime? @default(now())
  updatedAt                DateTime? @updatedAt
  role                     Role      @default(STUDENT)
  tutor                    Tutor?
  student                  Student?
}

model whitelist {
  id        Int
  token     String    @id @unique
  createdAt DateTime? @default(now())
}

model Student {
  id          Int    @id @default(autoincrement())
  profile_pic String
  user        User   @relation(fields: [userId], references: [id], onDelete: Cascade)
  userId      Int    @unique
}

model Conversation {
  id        Int       @id @default(autoincrement())
  status    String
  tutorId   Int
  studentId Int
  createdAt DateTime? @default(now())
  updatedAt DateTime? @updatedAt
}

model Chats {
  id         Int       @id @default(autoincrement())
  message    String
  senderId   Int
  receiverId Int
  createdAt  DateTime? @default(now())
  updatedAt  DateTime? @updatedAt
}

model Tutor {
  id                                 Int             @id @default(autoincrement())
  crb_check                          Boolean         @default(false)
  skype_id                           String          @default("")
  deActivate                         Boolean         @default(false)
  createdAt                          DateTime?       @default(now())
  updatedAt                          DateTime?       @updatedAt
  user                               User            @relation(fields: [userId], references: [id], onDelete: Cascade)
  userId                             Int             @unique
  referees                           Referees[]
  qualification                      Qualification[]
  tutoringDetail                     TutoringDetail?
  subjectOffers                      SubjectOffer[]
  documents                          Documents?
  is_account_approved                ApprovalStatus  @default(PENDING)
  is_profile_pic_approved            ApprovalStatus  @default(NOT_ADDED)
  is_government_document_approved    ApprovalStatus  @default(NOT_ADDED)
  is_qualification_document_approved ApprovalStatus  @default(NOT_ADDED)
  is_referee_approved                ApprovalStatus  @default(NOT_ADDED)
}

model Referees {
  id              Int              @id @default(autoincrement())
  first_name      String
  last_name       String
  email           String           @unique
  phone           String
  relation        RelationType     @default(OTHER)
  tutor           Tutor            @relation(fields: [tutorId], references: [id], onDelete: Cascade)
  tutorId         Int
  RefereesReviews RefereesReviews?
}

model RefereesReviews {
  referees               Referees @relation(fields: [refereeId], references: [id], onDelete: Cascade)
  refereeId              Int      @unique
  reliability_rating     Int
  trust_rating           Int
  professionalism_rating Int
  description            String
}

model Qualification {
  id                 Int    @id @default(autoincrement())
  degree_title       String
  level              String
  institute          String
  year_of_completion Int
  document           String
  tutor              Tutor  @relation(fields: [tutorId], references: [id], onDelete: Cascade)
  tutorId            Int
}

model TutoringDetail {
  id                  Int      @id @default(autoincrement())
  about               String
  year_of_experience  Int
  teaching_experience String
  approach            String
  availability        String[]
  tutor               Tutor    @relation(fields: [tutorId], references: [id], onDelete: Cascade)
  tutorId             Int      @unique
}

model SubjectOffer {
  id                Int     @id @default(autoincrement())
  title             String
  primary           Int     @default(0)
  secondary         Int     @default(0)
  gsce              Int     @default(0)
  higher_education  Int     @default(0)
  casual_learner    Int     @default(0)
  a_level           Int     @default(0)
  online_discount   Int     @default(0)
  first_free_lesson Boolean @default(false)
  in_person         Boolean @default(true)
  online            Boolean @default(true)
  tutor             Tutor   @relation(fields: [tutorId], references: [id], onDelete: Cascade)
  tutorId           Int
}

model Documents {
  id              Int    @id @default(autoincrement())
  id_card_front   String
  id_card_back    String
  criminal_record String
  tutor           Tutor  @relation(fields: [tutorId], references: [id], onDelete: Cascade)
  tutorId         Int    @unique
}

model Media {
  id   Int    @id @default(autoincrement())
  url  String
  type String
}

enum Role {
  STUDENT
  TUTOR
  ADMIN
}

enum RelationType {
  FRIEND
  TEACHER
  COLLEAGE
  CLIENT
  EMPLOYER
  OTHER
}

enum Availability {
  WEEKENDS
  WEEKDAYS
  EVENING
  MORNINIG
}

enum ApprovalStatus {
  PENDING
  APPROVED
  REJECTED
  NOT_ADDED
}
